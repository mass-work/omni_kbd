# omni CS ビルドガイド

**omni CS** をご購入ありがとうございます。
こちらは**omni CS**のビルドガイドになります。
<img src="img/readme_top.jpg" width="600px">

## 目次
- [omni CS ビルドガイド](#omni-cs-ビルドガイド)
  - [目次](#目次)
  - [キット内容と必要なものの確認](#キット内容と必要なものの確認)
  - [トラックボールケースの組み立て](#トラックボールケースの組み立て)
    - [左トラックボールケース](#左トラックボールケース)
    - [右トラックボールケース](#右トラックボールケース)
  - [はんだ付け](#はんだ付け)
    - [ダイオード、ソケット、リセットスイッチ、L字ピンヘッダのはんだ付け](#ダイオードソケットリセットスイッチl字ピンヘッダのはんだ付け)
    - [マイコンのはんだ付け](#マイコンのはんだ付け)
    - [センサーのはんだ付け](#センサーのはんだ付け)
    - [基板と配線のはんだ付け](#基板と配線のはんだ付け)
  - [組み立て](#組み立て)
    - [タッチディスプレイの取り付け](#タッチディスプレイの取り付け)
    - [基板のテスト](#基板のテスト)
    - [本体の組み立て](#本体の組み立て)
  - [完成](#完成)
  - [最後に](#最後に)
   
## キット内容と必要なものの確認

**キット内容**

| No. | 部品名 | 数量 | 備考 |
| --- | --- | --- | --- |
| 1 | メイン基板 | 1個 | |
| 2 | トラボ基板 | 2個 | |
| 3 | メインケース | 1個 | |
| 4 | ボトムプレート | 1個 | |
| 5 | トラボケース(右) | 1個 | |
| 6 | トラボケース(左) | 1個 | |
| 7 | メインPCBベース(右) | 1個 | |
| 8 | メインPCBベース(左) | 1個 | |
| 9 | トラボPCBベース(右) | 1個 | |
| 10 | トラボPCBベース(左) | 1個 | |
| 11 | アジャスタ | 2個 | |
| 12 | アジャスタベース | 2個 | |
| 13 | ゴム脚 | 4個 | |
| 14 | 配線 | 一式 | |
| 15 | ベアリングユニット | 3個 | トラボケース(右)に組み込み済みの場合があります。 |
| 16 | 支持球 | 3個 | トラボケース(左)に組み込み済みの場合があります。 |
| 17 | マウスセンサー(PMW3360) | 2個 | 組み込み済みの場合があります。 |
| 18 | ソケット | 47個 | 組み込み済みの場合があります。 |
| 19 | ダイオード | 53個 | 組み込み済みの場合があります。 |
| 20 | L字ピンヘッダ(13ピン) | 1個 | 組み込み済みの場合があります。 |
| 21 | 樹脂用タッピングねじM2.6 | 40個 | 3Dプリント品締結用 |
| 22 | 樹脂用タッピングねじM2 | 12個 |メイン基板、トラボ基板用|
| 23 | ねじM2 | 4本 | タッチディスプレイ用 |
| 24 | リセットスイッチ | 1個 | 組み込み済みの場合があります。 |
| - | 25mmPOM球(黒) | 1個 | |

- **別途購入が必要な部品**

| No. | 部品名 | 数量 | 備考 |
| --- | --- | --- | --- |
| 25 | Raspberry Pi Pico | 1個 | |
| 26 | ピンヘッダ 1x20(高さ2.5mm) | 2個 | |
| 27 | 1.28インチ円形タッチスクリーンディスプレイ (WaveShare) | 1個 | [リンク](https://www.waveshare.com/1.28inch-Touch-LCD.htm) |
| - | キースイッチ | 47個 | |
| - | キーキャップ | 1U:46個、1～1.5U:1個 | |
| - | トラックボール | 44mm(34mmOPの場合は34mm) | 44mmはProtoArc EM03、ELECOM DEFT PROから部品取り、または海外通販サイトで購入可能です。 |

- 工具、その他
  
| 工具名 | 数量 | 備考 |
| --- | --- | --- |
| はんだ | 適量 | |
| はんだごて | - | |
| マスキングテープ | - | |
| カッター | - | |
| ニッパー | - | |
| ワイヤーストリッパー | - | |
| 接着剤(エポキシ系2液混合タイプ) | - | |
| プラスドライバー(#0, #1) | - | |

<img src="img/build_02_01.jpg" width="600px">
<img src="img/build_02_02.jpg" width="600px">

---
## トラックボールケースの組み立て
### 左トラックボールケース
エポキシ系の接着剤でトラックボールケースに支持球を接着します。
1. 接着剤を爪楊枝などで混ぜます。
2. トラックボールケースのくぼみ3か所に少量塗布します。
   <img src="img/build_03_01.jpg" width="300px"> <img src="img/build_03_02.jpg" width="169px">

3. ピンセットなどで支持球をくぼみに入れます。
4. 軽く指の腹で押え、支持球の浮きがないようにします。
   <img src="img/build_03_03.jpg" width="300px"><img src="img/build_03_04.jpg" width="300px">

### 右トラックボールケース
ベアリングユニットをトラックボールケースに取り付けます。
1. ケースのベアリング挿入部に不要な塗膜がついていないか確認します。
   塗装がついている場合は、ドライバーや細いやすりで除去してください。
2. ベアリングユニットをケースに乗せ、軸を押し込みます。
<img src="img/build_04_01.jpg" width="300px"> <img src="img/build_04_02.jpg" width="300px">
<img src="img/build_04_03.jpg" width="300px"> <img src="img/build_04_04.jpg" width="300px">

---
## はんだ付け
> [!TIP]
はんだ付けが初めての場合は、事前にネットショップなどで販売している練習キットで練習しておくことをお勧めします。
スルーホールのはんだ付け、SMD(表面実装)のはんだ付けを出来るようにしてから組み立てを行うことを推奨します。
スルーホールのはんだ付け後、飛び出した部分をカットする工程がありますが、カット後に再度コテをあて、はんだを溶かすことで、内部応力を除去することを推奨します。(この作業は必須ではありません。長期的に使用した場合に、はんだが割れるリスクが下がります。)

### ダイオード、ソケット、リセットスイッチ、L字ピンヘッダのはんだ付け
※この項目はPCBAによりあらかじめ取り付け済みの場合があります。
　その場合は該当箇所を飛ばして進めてください。
1. 全てのダイオードとソケット取り付け部の片側に予備はんだをします。
   <img src="img/build_05_02.jpg" width="300px">
   
2. ダイオードとシルクが図の向きになるように置き、ピンセットでダイオードを押えながら予備はんだしたところにはんだごてをあてはんだ付けします。
   <img src="img/build_05_01.jpg" width="300px">

3. 全てのダイオードの片側をはんだ付けしたら、各ダイオードの反対側にもはんだ付けをします。
> [!WARNING]
ダイオードの向きに注意してください。ダイオードには極性があり、向きを間違えると正常に動作しません。
基板のシルクの切り欠き(コ)に合わせ図の様に配置してください。
<img src="img/build_05_03.jpg" width="300px"> 

4. 同じ要領でソケットをはんだ付けします。  
    <img src="img/build_05_05.jpg" width="300px"> <img src="img/build_05_06.jpg" width="300px"> 
   
5. リセットスイッチを裏側から入れ、表側からはんだ付けします。
   <img src="img/build_05_10.jpg" width="300px"> <img src="img/build_05_11.jpg" width="300px">  
   
6. L字ピンヘッダをはんだ付けします。
   
7. 裏側からL字ピンヘッダ差し込み、傾かないようにディスプレイのQIコネクタを両端にさしマスキングテープで固定します。
   <img src="img/build_05_07.jpg" width="300px"> <img src="img/build_05_08.jpg" width="300px">  
8. 表側からはんだ付けします。
   <img src="img/build_05_09.jpg" width="300px"> 

### マイコンのはんだ付け
1. 基板裏側に1x20のピンヘッダを2つ載せ、その上にRaspberry Pi Picoを載せます。
   この時に基板表側へのピンの飛び出しが小さくなるようにしてください。
(飛び出しが大きい場合はカットして下さい。基板側1mm以下、Pico側3mm以下にしてください。)
   <img src="img/build_06_01.jpg" width="300px"> <img src="img/build_06_02.jpg" width="300px"> 

2. 基板側とPico側が浮かないようにはんだ付けを行います。
    <img src="img/build_06_03.jpg" width="300px"> 

> [!NOTE]
> まずは1箇所はんだ付けし、Picoを押えながら今付けた箇所に再度はんだごてを当て溶かすと密着させやすいです。
> 最初の数か所は順に上記手順を実行することで、Pico、基板がソケットに密着します。

### センサーのはんだ付け
※PMW3360はあらかじめ取り付け済みの場合があります。
　その場合は該当箇所を飛ばして進めてください。
1. トラボ基板にPMW3360をはんだ付けします。
2. 向きに注意してください。
   センサーの白丸があるところが、基板シルクのC13側になるようセンサーを取り付けます。
    <img src="img/build_07_01.jpg" width="300px"> 

3. 浮きがないようにマスキングテープなどで仮固定し、はんだ付けを行います。
    <img src="img/build_07_02.jpg" width="300px"> <img src="img/build_07_03.jpg" width="300px"> 
4. マスキングテープを剥がします。

### 基板と配線のはんだ付け
1. 配線の被覆を5mm程度向き、予備はんだをしておきます。
    <img src="img/build_08_01.jpg" width="300px"> 
2. トラボ基板とメイン基板の配線の対応は下図のようになります。
   下図でみえている側から差し込み、反対側からはんだ付けしていきます。
    <img src="img/build_08_05.jpg" width="300px"> 
   
   | 配線長さ(mm)  | 右用(図では左側) | 左用(図では右側) |
   | ---          | ---             | ---             |
   | 黒           | 230             | 270             |
   | 赤           | 230             | 265             |
   | 白           | 235             | 260             |
   | 黄           | 235             | 255             |
   | 青           | 240             | 250             |
   | 緑           | 240             | 245             |
    
3. トラボ基板に配線を差し込み、マスキングテープで仮止めし、はんだ付けします。
    <img src="img/build_08_02.jpg" width="300px"> <img src="img/build_08_03.jpg" width="300px"> 
4. メイン基板も同様に配線を差し込みはんだ付けします。
    <img src="img/build_08_06.jpg" width="300px"> 
5. はんだ付け後先端の余分に飛び出している部分はカットします。
   <img src="img/build_08_04.jpg" width="300px"> 
   
---
## 組み立て

### タッチディスプレイの取り付け
1. L字ピンヘッダにQIコネクタを差し込み、基板の穴からコネクタを表側に出します。
    <img src="img/build_09_01.jpg" width="300px"> <img src="img/build_09_02.jpg" width="300px"> <img src="img/build_09_03.jpg" width="300px"> 
2. タッチディスプレイとコネクタを接続します。
    <img src="img/build_09_04.jpg" width="300px"> 
3. 基板、スペーサ、タッチディスプレイをM2のネジで固定します。
   タッチディスプレイのネジ穴がシールで保護されている場合は取り付け前に剥がしてください。
    <img src="img/build_09_05.jpg" width="300px"> <img src="img/build_09_06.jpg" width="300px">  <img src="img/build_09_07.jpg" width="300px"> 
    <img src="img/build_09_08.jpg" width="500px"> 

### 基板のテスト
1. [こちら](../build)からomni_cs_00_00_00_vial.uf2のfirmwareをダウンロードします。(数値部分はバージョンによって異なります)
2. Raspberry Pi Picoのbootボタンを押しながらUSBにさします。
3. 下図の画面が立ち上がったら、ダウンロードしたfirmwareをドラッグアンドドロップで移します。
    <img src="img/build_10_01.jpg" width="500px"> 

  **確認項目**
  Raspberry Pi PicoをUSBに繋ぎ以下を確認してください。
   - ディスプレイが表示されているか
   - スワイプや長押し(3秒以上)が反応するか
   - レンズがついた状態でトラックボールセンサーが反応するか(指でなぞりカーソル、スクロールが動くか)
   - キースイッチが反応するか(各キーのピンをピンセットなどで触り導通させてください。)
      <img src="img/readme_layer.gif" width="300px"> 

### 本体の組み立て
1. PCBベースに基板を仮止めします。(一度締結した後に1/4回転程度ネジを戻してください。)
   PCBベースLRに2カ所ずつ突起があるので、基板の位置決め穴に合わせてください。
    <img src="img/build_12_01.jpg" width="400px"> <img src="img/build_12_02.jpg" width="400px"> 
2. トラボ基板とトラボPCBベースをネジで固定した後、配線を固定します。
   トラボPCBベースは角度が垂直に近い方が左手用(25mm用)になります。
    <img src="img/build_12_03.jpg" width="400px"> <img src="img/build_12_04.jpg" width="400px"> 
3. タッチディスプレイの配線はマスキングテープで止め、センサーの配線をPCBベースに沿わせて固定します。   
   <img src="img/build_12_05.jpg" width="400px"> 
   センサーの配線の長さは下図を参考に調整してください。
      <img src="img/build_12_06.jpg" width="400px"> <img src="img/build_12_07.jpg" width="400px"> 
4. PCBベースとボトムプレートを仮止めします(一度締結した後に1/4回転程度ネジを戻してください。)。
   <img src="img/build_12_08.jpg" width="400px"> <img src="img/build_12_09.jpg" width="400px"> 
5. 先ほど仮止めした基板とPCBベースのネジを締めて固定します。
   <img src="img/build_12_02.jpg" width="400px"> 
6. ボトムプレートにトラボPCBベースを取り付けます。
   <img src="img/build_12_10.jpg" width="400px"> 
7. タッチディスプレイの保護シールを剥がし、メインケースをボトムプレートに載せます。
   三枚目のように奥側から入れると取り付けやすいです。
    <img src="img/build_12_11.jpg" width="400px"> 
    <img src="img/build_12_13.jpg" width="400px"> <img src="img/build_12_12.jpg" width="225px"> 
8.  両端の4箇所にキースイッチを入れます。
    ※基板が少し動く状態でスイッチでPCBとメインケースの位置合わせをしています。
   <img src="img/build_12_14.jpg" width="400px"> 
9.  ボトムプレートにボールケースを載せます。
   <img src="img/build_12_15.jpg" width="400px"> 
10. メインケース、ボールケースにM2.6のネジ取り付け、仮止めしていたネジを全て締めます。
    その後、アジャスター、ゴム脚を付けます。
    赤丸部はネジを取り付けてください。
    その他の穴はボトムプレートとの間に隙間がある場合など、気になる場合は取り付けてください。
   <img src="img/build_12_16.jpg" width="400px"> 
11. 残りのキースイッチ、キーキャップ、トラックボールを取り付けます。
   <img src="img/readme_top.jpg" width="400px">

---
## 完成
組み立てお疲れさまでした。
これでomni CSの完成になります。
使い方は[readme](../readme.md)をご確認ください。

---
## 最後に

もしよろしければ、完成品を[X](https://x.com/home)などのSNSにハッシュタグ#omni_kbdを付けて投稿いただけるとうれしいです。
また、サポートが必要な場合やご意見などありましたら、ディスコードのコミュニティまでご連絡下さい。
